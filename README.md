# datest接口自动化测试平台v1.0

## 简介：
本平台充分将pytest,django,httprunner,restframework等大量python模块进行整合，构建了一套包括接口管理，参数管理，用例管理，集合管理，批次管理，测试报告管理，认证和权限管理等一系列模块，并能根据设置运行测试用例，运行测试套件，生成测试报告，记录测试结果，并可以进行持续集成，并发送测试报告。
本框架充分将大量python模块进行整合，构建了一套包括接口管理，参数管理，用例管理，集合管理，批次管理，测试报告管理，认证和权限管理等一系列模块，并能根据设置运行测试用例，运行测试套件，生成测试报告，记录测试结果。

## 特点：
1. 实现模块化，不需要造汽车，造飞机，只需要结合现合工具进行逻辑开发或二次开发，具有易开发、易扩展、易维护等特点。
2. 对接口、用例中的请求数据、校验数据、测试结果等在数据库进行操作，可多次使用，便于新建、编辑等操作。
3. 使用django的权限和认证模块，无需自己开发，减少工作量，减少因此造成的缺陷。

## 主要功能
![blockchain](https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/)
本测试平台分为后台，中台，前台三个部分，后台由django框架管理测试类数据，中台根据后台配置的数据生成测试文件，运行测试用例、测试套件、测试批次，前台可直接请求接口并进行验证，根据响应自动生成断言，编辑测试驱动方法等。

## 主要模块
![blockchain](https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/)

## 操作说明
### 一. 接口管理
接口管理可以对接口数据进行增删改查，并支持批量导入与批量导出，可对接口进行分组。

#### 1.操作
##### 导入
可批量导入接口，导入后默认为有效，header字段不存在将自动新增。
   
##### 导出
根据选择的接口批量导出。
   
### 二. 测试用例管理
测试用例管理可以对测试用例数据进行增删改查，可进行多种设置，可直接根据测试用例的数据发送请求，生成断言，测试后可直接查看测试报告。

#### 1.参数
##### 环境地址
可选择或新增环境，如www.baidu.com:8000

##### 测试接口
可搜索选择状态为有效的接口。

##### 是否有效
状态为有效的测试用例数据才能在测试套件中选择。

##### 请求参数类型-请求报文
如果请求参数类型选择JSON，发送请求为请求报文文本框内输入的json格式的文本，格式必须正确
如果请求参数类型选择FORM-DATA，发送请求为请求报文文本框内输入的请求参数，格式为
参数：值
参数：值
参数：值
每一个空一行
如果请求参数类型选择FORM-DATA，而且请求报文文本框内未输入内容，可手动加入FORM-DATA并保存入库。如请求报文文本框有内容，此处输入内容无效。

##### 自定义函数
可在驱动文件中修改项目的测试驱动文件中编写自定义函数，在请求报文输入框，FORMDATA参数输入框，自定义请求头输入框可使用自定义函数，可使用${方法名(参数)}获得变量

##### 自定义前置方法
可在驱动文件中修改项目的测试驱动文件中编写自定义前置方法，参数为request，request为requests.request方法参数组成的数组，可以新建前置方法${方法名($request)}对request对象操作后发送请求。

##### 自定义运行方法
运行方法可在脚本中自定义配置，文件为apitest/runner/callfunc.py，原始方法为default_func，如不设置默认使用原始方法，可在脚本内加入自定义方法对测试用例中设置的值进行自定义操作，有较高的灵活性，但需要一定编程基础。

##### 自定义请求头输入框
加入额外的请求头，如存在与API请求头重复则覆盖。

##### 复用历史参数
在请求报文输入框，FORMDATA参数输入框，自定义请求头输入框请求参数的值可以设置为之前用例中的响应保存中设置的值，格式为”&$.用例编号.requestdata(responsedata).参数&”，用例编号必须为已经运行用例，复用的用例编号必须已经运行，否则将报错，需要自己根据先后关系排列用例，一般为使用测试套件对用例进行排序运行。

##### 校验参数
取值目前使用jmespath取值，根据设置的模式进行断言，例：{code:0,msg:”成功”,content:{“name”:”mike”,}}，取name值就是body.content.name。校验参数不可使用复用历史参数。

#### 1.操作
##### 导入
可批量导入测试用例，导入后默认为有效，可以导入附加的header字段，api为接口数据的id，请求报文目前只支持导入JSON数据，断言格式为断言json路径|预期值，请参考用例导入模板。

##### 复制
可对测试用例进行复制，生成新的用例编号。

##### 生成文件
在apitest/runner/data下生成yaml格式的测试用例文件，可以直接运行apitest/runner下的testrunner脚本运行此yaml文件。

##### 运行选中用例
逐个运行勾选的所有测试用例，并为每个用例生成allure测试报告及测试报告模块下测试结果数据。

##### 查看报告
运行完成后可查看此用例最后一次运行生成的测试结果和测试报告，测试报告详细记录了本次测试的请求、响应、断言、日志等数据。

##### 发送
点击后根据测试数据发送请求取得响应

### 三. 驱动文件管理
可实时编辑测试驱动函数

#### 1.操作
##### 编辑
保存后可在测试用例内使用自定义函数和前置后置方法

### 四. 测试集合管理
测试集合管理可以对批量加入测试用例并运行生成测试报告，也可构建指定顺序的测试用例集，并可进行多种pytest设置来运行套件，套件中的设置将覆盖用例中的设置。

#### 1.参数
##### 是否顺序执行
选是，可指定顺序添加测试用例，运行时根据顺序运行用例指定的顺序运行用例。选择否，按照在用例集中添加的测试用例进行运行，顺序根据用例id排序。

#### 2.操作
##### 生成文件
在apitest/runner/data下生成yaml格式的测试用例文件，可以直接运行apitest/runner下的testrunner脚本运行此yaml文件。

##### 运行选中套件
逐个运行勾选的所有测试套件，并为每个套件生成allure测试报告及测试报告模块下测试结果数据。

##### 查看用例
跳转测试用例列表，结果为所有该套件下的用例。

### 五. 测试批次管理
测试批次管理可以对批量加入测试套件并运行

#### 1.操作
##### 生成文件
在apitest/runner/data下生成yaml格式的测试用例文件，可以直接运行apitest/runner下的testrunner脚本运行此yaml文件。

##### 运行选中套件
运行批次中所有的测试套件，并为每个套件生成测试报告及测试报告模块下测试结果数据。

### 六. 测试报告管理
可查看运行测试用例以及运行测试套件后生成的测试结果信息，点击查看报告可查看测试报告。删除测试报告数据将同时删除文件中的测试报告文件。

#### 1.操作
##### 查看报告
跳转本次测试的本地测试报告网页，测试报告详细记录了本次测试的请求、响应、断言、日志等数据，并根据用例分组分组。

##### 详情
显示运行测试用例或套件的结果。

##### 查看失败用例
跳转测试用例列表，结果为所有本次测试结果为失败的用例。

### 七. 用户管理
本框架使用了django的用户管理模块，可新增用户并对用户的权限，状态等进行管理，无需自己编写用户模块。

